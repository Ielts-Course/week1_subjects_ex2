<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Stage 3: Fill in the blanks — Mobile Optimized</title>
  <style>
    :root{
      --bg:#f9f9f9;--card:#fff;--text:#222;--muted:#666;--brand:#2f6feb;
      --radius:12px;--shadow:0 4px 12px rgba(0,0,0,.06);
      --gap:12px;--gap-lg:16px;
      --fs-body:clamp(16px, 1.9vw, 18px);
      --fs-h:clamp(18px, 2.4vw, 24px);
      --tap-target:clamp(44px, 9vw, 52px);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size:var(--fs-body); line-height:1.55; padding: clamp(12px, 3vw, 24px);}

    .container{width:100%; margin:0 auto; padding:0;}
    .card{background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow); padding: clamp(14px, 3vw, 20px); width:100%;}

    /* Header */
    .header{display:flex; justify-content:center; align-items:center; gap:10px; padding-bottom:12px; margin-bottom:12px; border-bottom:1px solid #eee; text-align:center}
    .header img{height:clamp(22px, 6vw, 32px); width:auto; max-width:48px}
    .titleblock{font-weight:800; line-height:1.2; font-size:var(--fs-h); flex:1 1 auto; min-width:0;}
    .titleblock small{display:block; font-weight:600; color:#555; margin-top:4px; font-size:clamp(13px,1.6vw,15px)}
    .card img{max-width:100%; height:auto;} /* keep header img controlled by its own rule */

    /* Instruction */
    #instruction{ text-align:center; font-style:italic; color:#444; margin: .6rem 0 1rem; padding:0 .25rem; }

    /* Sentences */
    .sentence-container{background:var(--card); padding:0; margin:0 auto; width:100%;}
    .sentence{padding:.8rem 1rem; margin:.5rem auto; background:#fff; border-radius:10px; box-shadow:0 1px 4px rgba(0,0,0,.05); display:block; word-break:break-word; overflow-wrap:anywhere;}

    /* Selects */
    select{display:inline-flex; min-height:var(--tap-target); font-size:1em; padding:.28rem .45rem; margin:0 .15rem; border-radius:10px; border:1px solid #bbb; background:#f7f8ff; width:auto; min-width:10ch; max-width:18ch; vertical-align:baseline;} 
    /* prevent breaks around the select on all devices */
    .nowrap-group{display:inline-flex; align-items:baseline; gap:.2rem; white-space:nowrap;} 
    .nowrap-group select{margin:0 .15rem;} 
    select:focus{outline:3px solid rgba(47,111,235,.25)}
    .translation{color:var(--muted); font-size:.9em; margin-top:.25rem}

    /* Submit button */
    #submit{display:block; margin:1rem auto; padding:.6rem 1rem; min-height:var(--tap-target); font-size:1.05em; border:0; border-radius:12px; cursor:pointer; background:var(--brand); color:#fff; box-shadow:0 2px 8px rgba(0,0,0,.08)}

    .correct{color:green; font-weight:700}
    .incorrect{color:#e53935; font-weight:700}

    footer{text-align:center; margin-top:18px; color:#666; font-size:13px}

    /* Small screens */
    @media (min-width:600px) and (max-width:1024px){
      /* Tablet/iPad tweaks: keep logo modest */
      .header img{height:36px; max-width:48px}
      .header{gap:10px}
    }

    @media (max-width:600px){
      body{padding:12px}
      .card{border-radius:0; box-shadow:none; padding:14px;}
      .header{gap:8px}
      .header img{height:24px; max-width:36px}
      .sentence{padding:.85rem .8rem}
      select{display:inline-flex; width:auto; min-width:9ch; max-width:16ch; margin:0 .15rem; font-size:.95em}
    }
      .card{border-radius:0; box-shadow:none; padding:14px;}
      .header{gap:8px}
      .header img{height:24px; max-width:36px}
      .sentence{padding:.85rem .8rem;}
      /* Keep selects inline but compact on phones */
      select{display:inline-block; width:auto; min-width:10ch; max-width:16ch; margin:0 .15rem; font-size:.95em}
    }
      .card{border-radius:0; box-shadow:none; padding:14px;}
      .sentence{padding:.9rem .85rem;}
      /* Keep selects inline but compact on phones */
      select{display:inline-block; width:auto; min-width:12ch; max-width:22ch;}
    }
      .card{border-radius:0; box-shadow:none; padding:14px;}
      .sentence{padding:.9rem .85rem; display:block;}
      select{display:block; width:100%; margin:.4rem 0}
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion:reduce){ *{animation:none!important; transition:none!important} }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <div class="header">
        <img src="LOGO.png" alt="Logo" />
        <div class="titleblock">教育部 - 出国人员培训部<small>第1周 • 词汇练习</small></div>
      </div>

      <p id="instruction">Choose the most suitable word to complete each sentence. Clues are provided in Chinese.</p>

      <div class="sentence-container" id="exercise"></div>
      <button id="submit" type="button">Submit Answers</button>
      <div id="score-report" style="text-align:center; font-size:1.05rem; margin-top:.8rem;"></div>
      <div id="right-answers" style="margin:.6rem auto 0; font-size:1rem; line-height:1.5;"></div>

      <footer>©2025 Dr. Carlos Cardenas • 教育管理学博士</footer>
    </div>
  </div>

  <script>
    const data = [
      ["Math", "useful", "有用的", "I can use it to plan my budget."],
      ["Undergraduate study", "fun", "有趣的", "I can join many clubs."],
      ["Physical education", "tiring", "累人的", "I need to rest after class."],
      ["Math", "confusing", "令人困惑的", "I don’t understand some of the problems."],
      ["History", "interesting", "有趣的", "I love hearing the stories about our country’s past."],
      ["Literature", "inspiring", "鼓舞人心的", "It makes me want to write."],
      ["Physics", "challenging", "有挑战性的", "Some ideas are hard to understand."],
      ["An exchange program", "fascinating", "迷人的", "I can see how people live in other countries."],
      ["Graphic design", "practical", "实用的", "I can use it to make posters."],
      ["Graduate research", "complex", "复杂的", "The work has many small parts."],
      ["Business", "innovative", "创新的", "People come up with new product ideas to sell."],
      ["Biology", "motivating", "激励人的", "It makes me want to protect animals."]
    ];

    const adjectives = [...new Set(data.map(d => d[1]))];
    const shuffled = data.sort(() => 0.5 - Math.random()).slice(0, 5);

    const container = document.getElementById("exercise");

    shuffled.forEach((item, index) => {
      const [subject, correct, translation, followUp] = item;
      const options = [correct, ...adjectives.filter(adj => adj !== correct).sort(() => 0.5 - Math.random()).slice(0, 3)];
      options.sort(() => 0.5 - Math.random());

      const wrapper = document.createElement("div");
      wrapper.className = "sentence";

      const selId = `sel-${index}`;
      // Build inline nodes and a no-wrap group around "... is [select]."
      const label = document.createElement('label');
      label.setAttribute('for', selId);
      label.style.position = 'absolute';
      label.style.left = '-9999px';
      label.textContent = `Choose adjective for ${subject}`;

      const group = document.createElement('span');
      group.className = 'nowrap-group';

      const before = document.createElement('span');
      before.textContent = `${subject} is`;

      const nbsp = document.createTextNode(' '); // non-breaking space

      const selectEl = document.createElement('select');
      selectEl.id = selId;
      selectEl.setAttribute('aria-label', `Choose adjective for ${subject}`);
      selectEl.dataset.answer = correct;
      selectEl.dataset.subject = subject;
      selectEl.dataset.followup = followUp;

      const optBlank = document.createElement('option');
      optBlank.value = '';
      optBlank.textContent = '— choose —';
      selectEl.appendChild(optBlank);

      options.forEach(opt => { const o=document.createElement('option'); o.value=opt; o.textContent=opt; selectEl.appendChild(o); });

      const dot = document.createElement('span');
      dot.textContent = '.';

      group.append(before, nbsp, selectEl, dot);

      const space = document.createTextNode(' ');
      const follow = document.createTextNode(followUp);

      const trans = document.createElement('div');
      trans.className = 'translation';
      trans.textContent = `(${translation})`;

      wrapper.append(label, group, space, follow, trans);
      container.appendChild(wrapper);
    });

    document.getElementById("submit").onclick = () => {
      const selects = document.querySelectorAll("select");
      let correctCount = 0;
      const missed = [];

      selects.forEach(sel => {
        sel.disabled = true; // lock after submit
        const userAnswer = sel.value;
        const correct = sel.dataset.answer;
        const isCorrect = userAnswer === correct;
        sel.className = isCorrect ? "correct" : "incorrect";
        if (isCorrect) {
          correctCount++;
        } else {
          const subj = sel.dataset.subject;
          const follow = sel.dataset.followup;
          missed.push(`正确句子：${subj} is ${correct}. ${follow}`);
        }
      });

      const scoreReport = document.getElementById("score-report");
      const total = selects.length;
      const percent = Math.round((correctCount / total) * 100);
      scoreReport.textContent = `${correctCount}/${total} correct – ${percent}%`;

      const feedbackDiv = document.getElementById("right-answers");
      if (missed.length) {
        feedbackDiv.innerHTML = missed.map(s => `<div>• ${s}</div>`).join("");
      } else {
        feedbackDiv.innerHTML = "<div>全部正确！做得好！</div>";
      }
    };
  </script>
</body>
</html>
